My database represents a music streaming system that includes 5 tables like artists, songs, plays, listeners and genres. All tables are related through primary and foreign keys, ensuring data consistency and logical connections between songs, artists, and plays (I'm sure it could be done better, but I did not have a lot of time to think more about it:(  ). The main SQL query shows how to work with real data using different SQL features. It starts with a CTE that selects only plays from the year 2025. Then it joins all five tables to combine data about songs, artists, genres, and listeners. A WHERE filter keeps only songs released after 2020. The query groups the results by song and counts how many times each one was played (GROUP BY and HAVING). A small subquery counts how many total plays each song has in the whole database. Finally, it sorts songs by number of plays (ORDER BY) and shows only the top 5 (LIMIT). At the end, a short UNION ALL query joins all artist names and song titles into one simple list.
